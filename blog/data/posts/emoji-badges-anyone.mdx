---
title: 'Emoji Badges, anyone?'
subtitle: 'Developing your own VS Code Snippet Extension'
date: '2020-02-17'
lastmod: '2020-02-17'
tags: ['vscode', 'emojis']
readingList: []
draft: false
summary: 'Developing your own VS Code Snippet Extension'
images: ['/static/images/blog/emojisanyone.png']
---

<InlineImage
  src="/static/images/blog/emojisanyone.png"
  alt="Featured image of this article showing Wordpress and Jekyll logo"
  caption={
    <>
      Image source: <a href="https://unsplash.com/photos/ouX2AlJFRUY">photo frame</a> and
      <a href="https://unsplash.com/photos/x2Tmfd1-SgA">plant</a> from Unsplash
    </>
  }
/>

### Introduction

Okay, I must admit that I love the idea of using icons and badges wherever possible. It adds colour to the otherwise monotonous page and immediately grabs your attention. Of course, youâ€™d still want to use it in moderation, just like with anything else.

![A build pipeline status badge generated by Azure DevOps](https://cdn-images-1.medium.com/max/800/1*Id8eJ68818xSOXXHaIptdg.png)

A build pipeline status badge generated by [AzureÂ DevOps](https://azure.microsoft.com/en-us/services/devops/)

![Code maintainability status badge generated by Code Climate](https://cdn-images-1.medium.com/max/800/1*ZyYTGOn5-78xWk18Mx8J7Q.png)

Code maintainability status badge generated by [CodeÂ Climate](https://codeclimate.com/)

While many services provide you with an option to generate a badge (like the examples above), you can also customise and build your own badge using [this tool](https://shields.io/category/build). How awesome is that?

### Welcome, EmojiÂ Badges

I thoughtâ€Šâ€”â€Šwouldnâ€™t it be a good idea to create a Visual Studio Code extension that allows you to add emoji badges to your markdown file? Hereâ€™s a GIF to show this in working:

![GIF showing Emoji Badges in working](https://cdn-images-1.medium.com/max/800/1*8iqosa4EWCxRGIGDvNb-7Q.gif)

[Emoji Badges](http://bit.ly/emoji-badges) inÂ working

This VS Code extension is available from the [Visual Studio Marketplace](http://bit.ly/emoji-badges). The list of available badges can be found [here](https://github.com/ClydeDz/emoji-badges-vscode/blob/master/list-of-badges.md). Once installed, in a markdown file, you would start by typing the prefix and a list of available badges should appear in the menu.

Now, how do you go about making this? Letâ€™s take a look.

### Prerequisites

- Download [Visual Studio Code](https://code.visualstudio.com/download).
- Install [Node.js](https://nodejs.org/en/download/) and NPM package manager. The Node.js installer will also install NPM. Verify installation: type `node â€“v` in the command prompt and you should get the Node.js version. Similarly, test the NPM installation using the command `npm â€“v`.
- Install vsce (short for Visual Studio Code Extensions) via NPM. vsce is a command-line tool for packaging, publishing and managing VS Code extensions. Use the command `npm install -g vsce`. Verify by running the command `vsce -V`.
- Create a Visual Studio Marketplace publisher profileâ€Šâ€”â€Šsteps outlined in the next section.

#### Creating a publisher profile

If you donâ€™t already have a Visual Studio Marketplace publisher profile, head over to https://marketplace.visualstudio.com/ and click on Sign in to sign-in with your Outlook/Microsoft email address. After that, click on Publish extensions link, as per screenshot below.

![Image showing VS Marketplace sign up steps.](https://cdn-images-1.medium.com/max/800/1*S-WkZjBKG8AbMWIjY8wsKg.png)

Complete the details in the Create Publisher screen and youâ€™ve successfully created your publisher profile. Make a note of the unique publisher IDâ€Šâ€”â€Šweâ€™d require that later.

![Image showing the create publisher page while signing up for VS Marketplace.](https://cdn-images-1.medium.com/max/800/1*glMJA9u_eP8ixsg2iDbg-g.png)

> **Note:** The details you enter in the above screen will show up on your publisher profile page. Click the link below to see what my Visual Studio Marketplace publisher profile looks like.

[**Publisher Clyde Dâ€™Souzaâ€Šâ€”â€ŠVisual Studio Marketplace**\
_Publisher clydedsouza, Clyde Dâ€™Souzaâ€Šâ€”â€ŠVisual Studio Marketplace. Currently working as a software developer at Datacomâ€¦_&#x6D;arketplace.visualstudio.com](https://marketplace.visualstudio.com/publishers/clydedsouza 'https://marketplace.visualstudio.com/publishers/clydedsouza')[](https://marketplace.visualstudio.com/publishers/clydedsouza)

### Source code and extension

Before we dive into the implementation steps, let me leave you with a link to my Code extension that you can use as a reference while youâ€™re learning. Feel free to fork the repository and work from there, if thatâ€™s easier.

[**ClydeDz/emoji-badges-vscode**\
_Snippets to insert emoji badges to your markdown file. These are shields.io badges boosted with emojis ðŸ˜Ž Here are someâ€¦_&#x67;ithub.com](https://github.com/ClydeDz/emoji-badges-vscode 'https://github.com/ClydeDz/emoji-badges-vscode')[](https://github.com/ClydeDz/emoji-badges-vscode)

Click [here](http://bit.ly/emoji-badges) to view (and maybe also install?) my VS Code extensionâ€Šâ€”â€ŠEmoji Badgesâ€Šâ€”â€Šon the Visual Studio Marketplace.

### Structuring yourÂ code

Letâ€™s add these files and folder to your directory.

![Basic directory structure of a VS Code extension.](https://cdn-images-1.medium.com/max/800/1*o64axOxfosshKW9XGXz2Wg.png)

Basic directory structure of a VS Code extension. Iâ€™ve blurred out the files and folders thatâ€™s not required for a simple extensionâ€Šâ€”â€ŠIâ€™ve used them for custom requirements.

- **LICENSE**â€Šâ€”â€ŠDepending on how you choose to license your extension, add the appropriate license file to your repository. Visit [this website](https://choosealicense.com/) to choose between various license types.
- **README.md&#x200A;**â€”â€ŠDescription of what your Code extension does. Generally, a README file might only contain what the repository is for, but in this case, the contents of the README file will appear on the Code extension page.
- **.vscodeignore&#x200A;**â€”â€ŠWhen packaging our Code extension, we might not want to include all the files from our repository. This file tells the â€˜_packager_â€™ what files to exclude during this process.
- **package.json**â€Šâ€”â€ŠIf youâ€™ve used an NPM package before, you would be familiar with this file. In this case, this file contains some additional meta data about the extensionâ€Šâ€”â€Šalso called the â€˜extension manifestâ€™. More about this later in this article.
- **markdown.json in the snippets folder**â€Šâ€”â€ŠThis file is a collection of snippets that follow the same pattern. More about this later in this article.
- **Icon.png**â€Šâ€”â€ŠAn icon for this extension in PNG format. The official guide says the icon must be a minimum of 128x128 pixels (or 256x256 for Retina screens) but Iâ€™ve seen many extensions with a larger icon size as well. The icon size Iâ€™ve used for my Code extenion is 1024x1024 pixels. ðŸ˜…
- **Other files&#x200A;**â€”â€ŠIâ€™ve also added aÂ `.gitignore` file that tells GitHub what files to exclude from check-in. I have a `list-of-badges.md` file with a full list of available badges. A `demos` folder for capturing various demo snippets in action. An `images` folder to store the demo GIFâ€™s captured. A `tests` folder to write some basic unit tests. And finally, a `util` folder that has some JavaScript code to automatically update the `list-of-badges.md` file.

Letâ€™s elaborate on a few files.

### Package.json

A VS Code extension needs to have a `package.json` file present in the root directory of the extensionâ€™s directory structure. This file contains fields that give the marketplace more information about the VS Code extension. For example, setting the title, description and icon path in the `package.json` file will help the marketplace display the correct title, description and extension icon on the extensions page.

The `package.json` file contains quite a few fieldsâ€Šâ€”â€Šsome self-explanatory and some not so muchâ€Šâ€”â€Šand Iâ€™m not intending to cover all of them in this article. So, Iâ€™ll explain a few _not-so-self-explanatory_ ones (or some that require a special mention) here and for the rest, I trust you will [read the fabulous Code docs](https://code.visualstudio.com/api/references/extension-manifest). You can also check out my version of the `package.json` file [here](https://github.com/ClydeDz/emoji-badges-vscode/blob/master/package.json) to see what Iâ€™ve used and how its reflected on my [extensionâ€™s marketplace page](http://bit.ly/emoji-badges).

#### Publisher

You can get your publisher name from your publisher profile page URL. So, if the URL is `https://marketplace.visualstudio.com/publishers/johnsmith`, your publisher name/ID is `johnsmith`.

You can also navigate to the [manage publisher page](https://marketplace.visualstudio.com/manage/) and get the publisher name from there, as highlighted in the image below.

![Picture showing where to find the VS Marketplace publisher name/ID.](https://cdn-images-1.medium.com/max/800/1*GTAhlS5bwgQHQ_SKt6nUzQ.png)

#### Contributes

The contributes field describes the functionality that this extension providesâ€Šâ€”â€Šbasically what type of extension youâ€™re developing. It could be snippets, themes, menus, commands or anything from [this list](https://code.visualstudio.com/api/references/contribution-points).

In this case, weâ€™re creating an extension to add _snippets&#x20;_&#x77;hich will be available for _markdown&#x20;_&#x66;iles only. The relative file _path_ to the JSON file that contains a list of snippets is mentioned right below the supported language. The snippet file is named `markdown.json` since that is the language identifier. A list of available language identifiers can be found [here](https://code.visualstudio.com/docs/languages/identifiers) and you can only add snippets for languages thatâ€™s in this list.

#### Engines

This value indicates the VS Code version this extension is compatible with. A prefix of `^` indicates that this extension is compatible with the version specified and all higher versions of VS Code.

### markdown.json

As you might have observed, [this file](https://github.com/ClydeDz/emoji-badges-vscode/blob/master/snippets/markdown.json) is a collection of snippets that follow the same pattern. For example:

Now, very quickly â€”

- â€œamazon-followâ€ is the title of the snippet.
- â€œprefixâ€ is the trigger that helps Code decide which snippets it must show in IntelliSense. For example, in this case, if you start typing â€œamazonâ€ Code will show the above snippet in IntelliSense.
- â€œbodyâ€ is the contents of your custom snippet. On selecting this snippet, the contents of â€œbodyâ€ will be pasted into your file. In this case, Iâ€™ve populated each snippet with a custom badge that contains an emoji.
- And finally, the optional â€œdescriptionâ€ contains the message that will be displayed in IntelliSense.

![Image showing how to read a snippetâ€™s IntelliSense suggestion by VS Code.](https://cdn-images-1.medium.com/max/800/1*AQpIonhTmIob61qaTNfsMg.png)

Get creativeâ€Šâ€”â€Šcreate as many snippets in this file as you like.

### Testing the extension

![GIF showing a guy in a suit marking a check symbol in thin air.](https://cdn-images-1.medium.com/max/800/1*YPx2Bl1W7xHZOvBojiAKRA.gif)

GIF [source](https://giphy.com/gifs/bublywater-bubly-water-sparkling-KbvZsN07K9Hy9ZoyR7)

#### Debugging usingÂ Code

Click the Debug â†’ Start Debugging option to run a new instance of VS Code in debug mode with your extension already installed. I can now open up a markdown file and try adding some snippets thatâ€™ll create the emoji badges, as per screenshot below.

![Picture showing VS Code in debug mode.](https://cdn-images-1.medium.com/max/800/1*GzOuMdhMsbSWMdeefaz1jw.png)

#### Unit tests

I briefly mentioned that Iâ€™ve written [some unit tests](https://github.com/ClydeDz/emoji-badges-vscode/blob/master/tests/test.js) inside the `tests` folder. These tests will check if my snippet file exists, if all snippets are unique, and if the snippet JSON file is named after the language identifier specified.

Iâ€™ve used [Istanbul](https://github.com/istanbuljs)â€™s command line interface [nyc](https://github.com/istanbuljs/nyc) to generate a cobertura coverage report and [Mocha JUnit reporter](https://github.com/michaelleeallen/mocha-junit-reporter) to generate a JUnit XML report. Both, the cobertura report and JUnit XML report get injected into my [Azure DevOps pipeline](https://clydedsouza.visualstudio.com/Emoji%20Badges%20VS%20Code/_build/results?buildId=220&view=results) (Iâ€™ll cover setting up an Azure DevOps pipeline for a Visual Studio Extension in another article).

![Picture showing Azure DevOps build pipelineâ€™s test and code coverage screen for Emoji Badges.](https://cdn-images-1.medium.com/max/800/1*ztG_oHZLQQfrMiLi_RGwlA.png)

Iâ€™ve configured the `npm test` script in my `package.json` file to execute the full test suite as follows and confirm all is good.

```
â€œtestâ€: â€œnyc --reporter=cobertura mocha tests/test.js --reporter mocha-junit-reporter --timeout 10000 --exitâ€
```

### Publishing your extension

![GIF showing a guy press a red button.](https://cdn-images-1.medium.com/max/800/1*-R18XFZUHbKHsDUatfg-fQ.gif)

GIF [source](https://giphy.com/gifs/pandawhale-push-button-GVcQtnmqBiEg0)

#### Creating a personal accessÂ token

First, make sure you have an Azure DevOps organisation. If you donâ€™t have one, create one by following [this article](https://docs.microsoft.com/en-us/azure/devops/organizations/accounts/create-organization?view=azure-devops). Now, head over to your Azure DevOps organisation â†’ click on the User settings icon â†’ from the dropdown, select Personal access tokens.

![Picture showing where to find the personal access token creation option in Azure DevOps.](https://cdn-images-1.medium.com/max/800/1*busauHlcO86qep5i8jQ-XA.png)

Click on New Token â†’ Fill up a suitable name so you know what this token is used for â†’ from the Organisation dropdown, select All accessible organisation â†’ and set a suitable Expiration for this token.

From the Scopes section, click on the Show all scopes link that should be just above the create & cancel button. This will update the list of scopes. Search for Marketplace and check all the boxes under Marketplace.

![Picture showing how to create a personal access token in Azure DevOps.](https://cdn-images-1.medium.com/max/800/1*Ta45NbB_tZaTmscaBsIl8w.png)

Copy the personal access token. Weâ€™ll require it for the steps below.

#### Packaging the VS Code extension

Weâ€™ll now use the `vsce` CLI to package our code into a VS extension, i.e., aÂ `.vsix` file. Think of a VSIX file like a ZIP file that contains our extensionâ€™s code and a manifest file containing metadata about your extension.

> Iâ€™m using VS Codeâ€™s integrated terminal but you can the Command Prompt as well.

![Picture showing vsce package command typed in a VS Code terminal.](https://cdn-images-1.medium.com/max/800/1*10aOmJmMI9pUIe5xqtyQ5w.png)

To create your VS Code extension, weâ€™ll run the following command at the source codeâ€™s root directory, i.e., where the `package.json` file exists. Replace `<Extension-Name>` with the name of your extension.

```
vsce package --out <Extension-Name>.vsix
```

Youâ€™ll immediately notice aÂ `.vsix` file created in the directory.

#### Deploying the VS Code extension

Weâ€™re going to continue using the `vsce` CLI to deploy our VS Code extension to the Visual Studio Marketplace. Weâ€™ll run the command highlighted below and replace `<PAT>` with the personal access token generated from the step above and `<Extension-Name>` with the name of your extension.

```
vsce publish -p <PAT> --packagePath <Extension-Name>.vsix
```

You should see the status of the deploy command you just ran in the terminal window. Once successful, weâ€™ll head to the next step.

#### Confirm extension is published

Head over to the [manage publishers page](https://marketplace.visualstudio.com/manage/) to see your extension listed there. Confirm that the extension is public. You can also view the extension by clicking the 3-dots â†’ View Extension link from the context menu to confirm all the details on the extension page is correct before sharing it with your network.

![Picture showing the context menu besides the Emoji Badges VS Code extension in the Marketplace manage publishers page.](https://cdn-images-1.medium.com/max/800/1*v1uFX_OHvTBHzfyhRysapQ.png)

Click [here](http://bit.ly/emoji-badges) to view my VS Code extensionâ€Šâ€”â€ŠEmoji Badgesâ€Šâ€”â€Šon the Visual Studio Marketplace.

### Summary

Alright, time for a quick recap â€”

1. I started off with giving some context to this article and we then looked at what the Emoji Badges VS Code extension looks like.
2. We looked at a short prerequisites list which essentially needed you to install the required tools and create a publisher profile on the Visual Studio Marketplace. I also shared the link of my GitHub repository that contains the full source code for my Code extension.
3. Next, we looked at what files and folders weâ€™d require to add to our directory followed by a short explanation for each file.
4. I then elaborated on the `package.json` and `markdown.json` files. The `package.json` contains the publisher name, compatible VS Code versions, contributes section and many other fields. The `markdown.json` file contains all the snippets for the language weâ€™re writing our Code extension for (in this case: markdown).
5. I wrote about testing the Code extension using VS Code and writing some basic unit tests.
6. Towards the end, we looked at the steps required to publish this extension. We created a personal access token from Azure DevOps and saved it for later.
7. We then ran the `vsce package` command to package the Code extension. That is, converting our source code into aÂ `.vsix` file.
8. And lastly, we looked at publishing thisÂ `.vsix` file to the Visual Studio Marketplace using the `vsce publish` command, and then confirming that extensionâ€™s marketplace page has the correct details by visiting the [manage publishers page](https://marketplace.visualstudio.com/manage/).

Thatâ€™s it! Thanks for reading
